(this["webpackJsonpmeeting-display-frontend"]=this["webpackJsonpmeeting-display-frontend"]||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(8),c=n.n(s),i=(n(14),n(5)),u=n.n(i),o=n(6),l=n(1),h=n(2),m=n(4),f=n(3),p=(n(16),function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={time:a.currentTime()},a}return Object(h.a)(n,[{key:"checkTime",value:function(e){return e<10?"0"+e:e}},{key:"currentTime",value:function(){var e=new Date;return this.checkTime(e.getHours())+":"+this.checkTime(e.getMinutes())}},{key:"componentDidMount",value:function(){var e=this;this.intervalID=setInterval((function(){return e.tick()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"tick",value:function(){this.setState({time:this.currentTime()})}},{key:"render",value:function(){return r.a.createElement("span",{className:"clock"},this.state.time)}}]),n}(r.a.Component)),v=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e="status status-"+this.props.status.toLowerCase();return r.a.createElement("header",{className:"meeting-status"},r.a.createElement("div",{className:e}),r.a.createElement("h1",null,this.props.status),r.a.createElement("p",null,this.props.summary),r.a.createElement("h2",null,r.a.createElement(p,null)))}}]),n}(r.a.Component),y=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=[];return this.props.events.forEach((function(t){e.push(r.a.createElement("li",{key:t.time+Math.random()},r.a.createElement("span",null,t.time),t.summary))})),r.a.createElement("ul",null,e)}}]),n}(r.a.Component),d=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"getYMD",value:function(e){return"".concat(this.checkTime(e.getFullYear())).concat(this.checkTime(e.getMonth())).concat(this.checkTime(e.getDate()))}},{key:"checkTime",value:function(e){return e<10?"0"+e:e}},{key:"yMDToDate",value:function(e){var t=parseInt(e.substr(0,4)),n=parseInt(e.substr(4,2)),a=parseInt(e.substr(6));return new Date(t,n,a,0,0,0,0)}},{key:"render",value:function(){var e=[],t=new Date(Date.now()),n=new Date(t.getTime());n.setDate(t.getDate()+1);var a=new Date(t.getTime());a.setDate(t.getDate()+7),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);var s=this.getYMD(t),c=this.getYMD(n),i=this.props.name;if(i===c)e.push(r.a.createElement("h3",{key:"Tomorrow"},"Tomorrow"));else if(i!==s){var u,o=this.yMDToDate(i);if(o.getTime()<a.getTime()){u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()]}else{u="".concat(o.getDate()).concat(function(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}(o.getDate())," ").concat(["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()])}e.push(r.a.createElement("h3",{key:u},u))}var l=this.props.events;return e.push(r.a.createElement(y,{key:i+"Events",events:l})),r.a.createElement("div",null,e)}}]),n}(r.a.Component),g=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=[];this.props.list&&Object.keys(this.props.list).forEach((function(n){t.push(r.a.createElement(d,{key:n,name:n,events:e.props.list[n]}))}));return r.a.createElement("section",{id:"timeline"},t)}}]),n}(r.a.Component);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createElement("defs",null),w=r.a.createElement("g",{id:"Canvas_1",stroke:"none",strokeOpacity:1,fillOpacity:1,fill:"none",strokeDasharray:"none"},r.a.createElement("title",null,"Canvas 1"),r.a.createElement("g",{id:"Canvas_1: Layer 1"},r.a.createElement("title",null,"Layer 1"),r.a.createElement("g",{id:"Graphic_2"},r.a.createElement("path",{d:"M 41.577764 431.1588 L 47 436.581 L 52.422236 431.1588 L 57.84122 436.57776 L 52.418984 442 L 57.84122 447.42224 L 52.422236 452.8412 L 47 447.419 L 41.577764 452.8412 L 36.15878 447.42224 L 41.581016 442 L 36.15878 436.57776 Z",fill:"white"})))),O=function(e){var t=e.svgRef,n=e.title,a=D(e,["svgRef","title"]);return r.a.createElement("svg",k({viewBox:"36.15878 431.1588 21.68244 21.68244",width:21.68244,height:21.68244,ref:t},a),n?r.a.createElement("title",null,n):null,b,w)},E=r.a.forwardRef((function(e,t){return r.a.createElement(O,k({svgRef:t},e))})),T=(n.p,function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e="error "+(this.props.show?"error-show":"error-hide");return r.a.createElement("div",{className:e,onClick:this.props.onClick},r.a.createElement("i",null,r.a.createElement(E,null))," There was a problem updating the calendar. ",r.a.createElement("strong",null,"Tap to retry"))}}]),n}(r.a.Component)),j=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).backendUrl="http://localhost:4567",a.tickRate=1e4,a.timerID=null,a.datesAreOnSameDay=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},a.state={status:"Updating",summary:"Please wait...",eventsList:{},error:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),this.tickRate),this.tick()}},{key:"componentWillUnmount",value:function(){this.timerID=null}},{key:"async_fetch",value:function(){var e=Object(o.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(!(n=e.sent).ok){e.next=7;break}return e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 7:throw new Error(n.status);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"tick",value:function(){var e=Object(o.a)(u.a.mark((function e(){var t,n,a,r,s,c,i,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.async_fetch(this.backendUrl);case 3:t=e.sent,e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),console.log("Error thrown whilst calling `async_fetch`. Displaying error message"),this.setState({error:!0}),e.abrupt("return");case 11:this.setState({error:!1}),n=t.events,a=Date.now(),r=n.find((function(e){var t=Date.parse(e.start),n=Date.parse(e.end);return t<a&&n>a})),s=n.find((function(e){return Date.parse(e.start)>a})),c=this.findTimeGapsFor(n).find((function(e){return e.start>a})),i=null==r?"Available":"Busy",o=this.generateSummary(i,s,c),l=this.generateEventsList(n),this.setState({status:i,summary:o,eventsList:l,error:!1});case 21:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"findTimeGapsFor",value:function(e){var t=[];return e.forEach((function(n,a){if(0!==a){var r=Date.parse(n.start),s=r-10,c=e[a-1],i=Date.parse(c.end);if(s>i){var u=i+1,o=r-1;t.push({start:u,end:o})}}})),t}},{key:"refresh",value:function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tick();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSummary",value:function(e,t,n){if(null==n)return"";var a="Available"===e,r=a?"Next meeting ":"Next free ",s=new Date(Date.now()),c=new Date(s.getTime());c.setDate(s.getDate()+1);var i=new Date(Date.parse(t.start)),u=this.datesAreOnSameDay(s,i),o=this.datesAreOnSameDay(c,i),l="".concat(this.checkTime(i.getHours()),":").concat(this.checkTime(i.getMinutes())),h=new Date(n.start),m=this.datesAreOnSameDay(s,h),f=this.datesAreOnSameDay(c,h),p="".concat(this.checkTime(h.getHours()),":").concat(this.checkTime(h.getMinutes())),v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],y=v[i.getDay()],d=v[h.getDay()],g=o,k=u,D=y,b=l;return a||(g=f,k=m,D=d,b=p),g&&(r+="tomorrow "),k||g||(r+="on ".concat(D," ")),r+="at ".concat(b)}},{key:"generateEventsList",value:function(e){var t=this,n=new Date(Date.now());new Date(n.getTime()).setDate(n.getDate()+1);var a={};return e.forEach((function(e){var n=new Date(Date.parse(e.start)),r=new Date(Date.parse(e.end)),s=t.getYMD(n),c={time:"".concat(t.checkTime(n.getHours()),":").concat(t.checkTime(n.getMinutes())," - ").concat(t.checkTime(r.getHours()),":").concat(t.checkTime(r.getMinutes())),summary:e.summary};a[s]=a[s]||[],a[s].push(c)})),a}},{key:"getYMD",value:function(e){return"".concat(this.checkTime(e.getFullYear())).concat(this.checkTime(e.getMonth())).concat(this.checkTime(e.getDate()))}},{key:"checkTime",value:function(e){return e<10?"0"+e:e}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"App"},r.a.createElement(v,{status:this.state.status,summary:this.state.summary}),r.a.createElement(g,{list:this.state.eventsList}),r.a.createElement(T,{show:this.state.error,onClick:function(){return e.refresh()}}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.832e267b.chunk.js.map